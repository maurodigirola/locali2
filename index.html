function mostra(lista = locali) {
  aggiornaFiltri();
  const c = document.getElementById("lista");
  c.innerHTML = "";

  lista.forEach((loc) => {
    const idxGlobale = locali.findIndex(x => 
      x.nome === loc.nome &&
      x.zona === loc.zona &&
      (x.consigliatoDa || "â€”") === (loc.consigliatoDa || "â€”")
    );

    // Controlli permessi
    const isOwner = (loc.consigliatoDa || "").trim().toLowerCase() === myName.trim().toLowerCase();
    const isAdmin = myName.trim().toLowerCase() === "mauro di girolamo";

    // Costruzione HTML
    c.innerHTML += `
      <div class="card" data-idx="${idxGlobale}">
        <div>
          <strong>${loc.nome}</strong> ${loc.glutenFree === "si" ? "ðŸŒ¾ðŸš«" : ""}<br>
          Zona: ${loc.zona} <br>
          Tipo: ${loc.tipo} <br>
          Voto: ${loc.voto || "â€”"}<br>
          Consigliato da: ${loc.consigliatoDa || "â€”"}<br>
          <a href="${loc.link}" target="_blank">Link</a>
        </div>

        <div class="actions">
          <!-- STELLA DEI PREFERITI -->
          <button class="star ${isPreferito(loc.nome, loc.zona, loc.consigliatoDa) ? 'preferito' : ''}"
            title="Aggiungi ai preferiti"
            onclick="togglePreferito(
              '${loc.nome.replace(/'/g, '&#39;')}',
              '${loc.zona.replace(/'/g, '&#39;')}',
              '${(loc.consigliatoDa || '').replace(/'/g, '&#39;')}'
            )">
            ${isPreferito(loc.nome, loc.zona, loc.consigliatoDa) ? "\u2B50" : "\u2606"}
          </button>

          <!-- PULSANTI EDIT/REMOVE (solo per chi ha aggiunto o admin) -->
          ${(isOwner || isAdmin) ? `
            <button class="edit" onclick="modifica(${idxGlobale})">âœŽ</button>
            <button class="remove" onclick="rimuovi(${idxGlobale})">Ã—</button>
          ` : ""}

          <!-- COMMENTI -->
          <div class="comment-container">
            <span class="comment-count">${loc.commenti ? loc.commenti.length : 0}</span>
            <button class="comment" title="Commenti" onclick="apriCommenti(${idxGlobale})">ðŸ’¬</button>
          </div>
        </div>
      </div>`;
  }); // chiude forEach
} // chiude funzione mostra
